<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>DDT Experiment Setup</title>
    <style>
        body { font-family: sans-serif; padding: 2em; }
        label { display: block; margin-bottom: 0.5em; }
    </style>
</head>
<body>
    <h1>Delayed Discounting Task</h1>
    <form action="{{ url_for('start') }}" method="post">
        <label>Subject ID:
            <input type="number" name="subject_id" required>
        </label>
        <label>Session:
            <input type="number" name="session" required>
        </label>
        <label>Number of train trials:
            <input type="number" name="num_train_trials" value="5" required>
        </label>
        <label>Number of main trials:
            <input type="number" name="num_main_trials" value="20" required>
        </label>
        <label>
            <input type="checkbox" name="show_tutorial">
            Show tutorial
        </label>
        <button type="submit">Start Experiment</button>
    </form>
    
    <script>
        // Parse query string parameters
        const urlParams = new URLSearchParams(window.location.search);
        
        // Fields to check for query parameters
        const fields = ['subject_id', 'session', 'num_train_trials', 'num_main_trials', 'show_tutorial'];
        
        fields.forEach(fieldName => {
            const value = urlParams.get(fieldName);
            if (value !== null) {
                const element = document.querySelector(`[name="${fieldName}"]`);
                if (element) {
                    if (element.type === 'checkbox') {
                        element.checked = value.toLowerCase() === 'true' || value === '1';
                    } else {
                        element.value = value;
                    }
                    element.readOnly = true;
                    if (element.type === 'checkbox') {
                        element.disabled = true;
                    }
                }
            }
        });
    </script>
</body>
</html>
